{"blocks":{"languageVersion":0,"blocks":[{"type":"openWorkbook","id":"7RZo|3X,}zt}8X)m:cm*","x":-15,"y":105,"icons":{"comment":{"text":"打开或创建所有需要的工作簿","pinned":false,"height":80,"width":160}},"fields":{"FILE":"'E:/SeniorFall/blocklyTest/myBlocklyContent/data/测试数据.xls'","VAR":"src"},"next":{"block":{"type":"addWorkbook","id":"N{Gz@_c*]$Xb^Zs#Wx}3","fields":{"VAR":"localInfo"},"next":{"block":{"type":"CreateSheet","id":"lZk#7W:m!)J5.R4Z`czh","fields":{"Workbook":"localInfo","name":"'local'"},"next":{"block":{"type":"addWorkbook","id":"#-05Lw4GI-M5Rv$l8H7Z","fields":{"VAR":"foreignInfo"},"next":{"block":{"type":"CreateSheet","id":"f-G|NsKGX$;c~@K]lZp.","fields":{"Workbook":"foreignInfo","name":"'foreign'"},"next":{"block":{"type":"addWorkbook","id":"I`A~CXqOV+mg5gDLP0!O","fields":{"VAR":"nonResidentInfo"},"next":{"block":{"type":"CreateSheet","id":"pOMiL@G-Mt*jQWGd+BHN","fields":{"Workbook":"nonResidentInfo","name":"'nonResident'"},"next":{"block":{"type":"fetchRowNoheader","id":"(Qk1Im|L@7^akb;r#u8K","icons":{"comment":{"text":"为新建的三个工作簿填写表头","pinned":false,"height":80,"width":160}},"fields":{"Workbook":"src","row":"4","columnF":"'A'","columnT":"'E'","VAR":"infoHeader"},"next":{"block":{"type":"WriteRowNoheader","id":"?xF54[FC9|_fi@|sz?;3","fields":{"Workbook":"localInfo","row":"1","column_from":"'A'","column_to":"'E'","row_content":"infoHeader"},"next":{"block":{"type":"fetchRowNoheader","id":"I=sOONj!c}T-o@;gA{t/","fields":{"Workbook":"src","row":"1","columnF":"'G'","columnT":"'G'","VAR":"infoHeader"},"next":{"block":{"type":"WriteRowNoheader","id":"XKKEJ/T=M]7?hsdN({m=","fields":{"Workbook":"localInfo","row":"1","column_from":"'F'","column_to":"'F'","row_content":"infoHeader"},"next":{"block":{"type":"fetchRowNoheader","id":"YTCkT2$n9fMGUN.0xM7)","fields":{"Workbook":"src","row":"4","columnF":"'AA'","columnT":"'BK'","VAR":"infoHeader"},"next":{"block":{"type":"WriteRowNoheader","id":"tjO4pTa^H:nI1VX-e_R^","fields":{"Workbook":"localInfo","row":"1","column_from":"'G'","column_to":"'AQ'","row_content":"infoHeader"},"next":{"block":{"type":"SetCellValue","id":"lyeA44{1X^}?Pig0q)Cw","fields":{"Workbook":"localInfo","row":"1","column":"'AR'","value":"'免税收入'"},"next":{"block":{"type":"SetCellValue","id":"E@MvyWl$:.G`f}GzjT~-","fields":{"Workbook":"localInfo","row":"1","column":"'AS'","value":"'商业健康保险'"},"next":{"block":{"type":"SetCellValue","id":"%AR]BT:D#qH:HDT$mg:{","fields":{"Workbook":"localInfo","row":"1","column":"'AT'","value":"'税延养老保险'"},"next":{"block":{"type":"SetCellValue","id":"T91gR9c:c!!iKNx$T[cM","fields":{"Workbook":"localInfo","row":"1","column":"'AU'","value":"'其他'"},"next":{"block":{"type":"SetCellValue","id":"*^`)!2TWM%pECY]Ku{EU","fields":{"Workbook":"localInfo","row":"1","column":"'AV'","value":"'备注'"},"next":{"block":{"type":"SetCellValue","id":"H4km0._8eV2!9FXoYuF;","fields":{"Workbook":"localInfo","row":"1","column":"'AW'","value":"'允许扣除的税费'"},"next":{"block":{"type":"SetCellValue","id":"IZ$#z0hp55:TV`R%Mcqe","fields":{"Workbook":"localInfo","row":"1","column":"'AX'","value":"'减免税额'"},"next":{"block":{"type":"fetchRowNoheader","id":"9:R*x+]y9[}#1qn!eP,6","fields":{"Workbook":"localInfo","row":"1","columnF":"'A'","columnT":"'AQ'","VAR":"infoHeader"},"next":{"block":{"type":"WriteRowNoheader","id":"%Fa+S0rN3w2{6i=NY@Vi","fields":{"Workbook":"foreignInfo","row":"1","column_from":"'A'","column_to":"'AQ'","row_content":"infoHeader"},"next":{"block":{"type":"WriteRowNoheader","id":"pbbP!~rdo18m(31d$o*-","fields":{"Workbook":"nonResidentInfo","row":"1","column_from":"'A'","column_to":"'AX'","row_content":"infoHeader"},"next":{"block":{"type":"setto","id":"60q3KZiQ6[N4$M8(eqL2","icons":{"comment":{"text":"这三个变量用于指示在新建的工作簿中写入的行号，第1行为表头，所以初始值为2","pinned":false,"height":80,"width":160}},"fields":{"exp":"2","VAR":"localIndex"},"next":{"block":{"type":"setto","id":"zRkctpDzQ5j6bauGi1nI","fields":{"exp":"2","VAR":"foreignIndex"},"next":{"block":{"type":"setto","id":"+!38GtrP?U*yPAx@gi|a","fields":{"exp":"2","VAR":"nonResidentIndex"},"next":{"block":{"type":"For","id":"tZc*wB]adFwuw62D3Z8B","icons":{"comment":{"text":"循环，对源工作簿的每一行数据做同样的操作","pinned":false,"height":80,"width":160}},"fields":{"VAR":"i","start":"5","end":"144"},"inputs":{"content":{"block":{"type":"fetchRow","id":"L;*gWq.hy+rXP9Z1l+Ef","fields":{"Workbook":"src","row":"i","columnF":"'A'","columnT":"'BR'","VAR":"srcRow","header_row":"4"},"next":{"block":{"type":"IF","id":"*;k%%%,Fc7/6[dK;HnP=","icons":{"comment":{"text":"校验手机号码","pinned":false,"height":80,"width":160}},"inputs":{"condition":{"block":{"type":"isNone","id":"CEF9BV2(De853^x+L1iJ","fields":{"VAR":"srcRow['手机号码']","option":" is"}}},"content":{"block":{"type":"setto","id":"]K_xZK6UYBdjJ;DMz_M;","fields":{"exp":"'12345678910'","VAR":"srcRow['手机号码']"}}}},"next":{"block":{"type":"Else","id":"Bj28IUY~vXXgYV#UqRP/","inputs":{"content":{"block":{"type":"GetStringLength","id":"DMd@mdvlW!b}J4ilyrA@","fields":{"str":"srcRow['手机号码']","VAR":"teleLength"},"next":{"block":{"type":"SubString","id":"P6V?%)W_ToT~-fLrN*OR","fields":{"str":"srcRow['手机号码']","head":"1","tail":"1","VAR":"teleStart"},"next":{"block":{"type":"IF","id":"c;kK~XpQXteZT^*~=H8K","inputs":{"condition":{"block":{"type":"or","id":"U]{F8(G9DU_AOv[*r@y=","inputs":{"condition1":{"block":{"type":"Compare","id":"9}Gx2S@2a!FnOO!.m*.l","fields":{"value_type":"int","exp1":"teleLength","comparation":"!=","exp2":"11"},"next":{"block":{"type":"Compare","id":"7E.V^6g(/#RwedZvUJ]v","fields":{"value_type":"str","exp1":"teleStart","comparation":"!=","exp2":"'1'"}}}}}}}},"content":{"block":{"type":"setto","id":"IO*vWNtam/I|9|}#o7NW","fields":{"exp":"'12345678910'","VAR":"srcRow['手机号码']"}}}}}}}}}}},"next":{"block":{"type":"GetStringLength","id":"@@.A;rleR6i[/jEz.+?v","icons":{"comment":{"text":"为后续if else的逻辑块准备需要使用的数据","pinned":false,"height":80,"width":160}},"fields":{"str":"srcRow['证件号']","VAR":"idLength"},"next":{"block":{"type":"SubString","id":"deQ=*[c`tk3|UN?IKMSC","fields":{"str":"srcRow['证件号']","head":"1","tail":"2","VAR":"idStart"},"next":{"block":{"type":"IF","id":"WcB@ao`K3St{H0`$svQh","icons":{"comment":{"text":"非居民","pinned":false,"height":80,"width":160}},"inputs":{"condition":{"block":{"type":"or","id":"Fujt1`S8wgFgp798aVFx","inputs":{"condition1":{"block":{"type":"Compare","id":"r1/o?I;_YCpBiHwW#SXk","fields":{"value_type":"float","exp1":"srcRow['劳务收入_劳务税非居民']","comparation":">","exp2":"0"},"next":{"block":{"type":"Compare","id":"ITgGh,4Xu``+yBcJI2~t","fields":{"value_type":"float","exp1":"srcRow['劳务税率_劳务税非居民']","comparation":">","exp2":"0"},"next":{"block":{"type":"Compare","id":"zef@{#)O7Xjxj6vUB-Xo","fields":{"value_type":"float","exp1":"srcRow['劳务实发_劳务税非居民']","comparation":">","exp2":"0"},"next":{"block":{"type":"Compare","id":"Pjyi^|RTn97fo`l(cULr","fields":{"value_type":"float","exp1":"srcRow['劳务税_劳务税非居民']","comparation":">","exp2":"0"},"next":{"block":{"type":"Compare","id":"~|8kYr3m[TA_Hl^X(`cz","fields":{"value_type":"float","exp1":"srcRow['劳务应扣税_劳务税非居民']","comparation":">","exp2":"0"}}}}}}}}}}}}}},"content":{"block":{"type":"SetAreaText","id":"?Uuf#XtyBy`doDOvCUmX","icons":{"comment":{"text":"手机号码和身份证号有可能会被错误地解释为数字，需要修改单元格的数据类型。\n此处必须先修改数据类型再写入，若调换顺序会出现问题。","pinned":false,"height":80,"width":160}},"fields":{"Workbook":"nonResidentInfo","row_from":"nonResidentIndex","row_to":"nonResidentIndex","column_from":"'D'","column_to":"'D'"},"next":{"block":{"type":"SetAreaText","id":"G@{MJ5Mh%9kYCclI@cvo","fields":{"Workbook":"nonResidentInfo","row_from":"nonResidentIndex","row_to":"nonResidentIndex","column_from":"'K'","column_to":"'K'"},"next":{"block":{"type":"WriteRow","id":"U390tO-08yH3#X@AlJ;r","fields":{"Workbook":"nonResidentInfo","row":"nonResidentIndex","column_from":"'A'","column_to":"'AX'","row_content":"srcRow","header_row":"1"},"next":{"block":{"type":"setto","id":"S[11G7(P~N7W%kA8).EF","icons":{"comment":{"text":"写入一行后，将用于指示写入行的变量加1，指向下一行","pinned":false,"height":80,"width":160}},"fields":{"exp":"nonResidentIndex + 1","VAR":"nonResidentIndex"}}}}}}}}}},"next":{"block":{"type":"Elif","id":"a.@m/}mPi[P3i]rW!A2S","icons":{"comment":{"text":"中国","pinned":false,"height":80,"width":160}},"inputs":{"condition":{"block":{"type":"and","id":"U8mFk:3m.2N%R!9f#4_P","inputs":{"condition1":{"block":{"type":"Compare","id":"W]qj@fUhE/:Mkwpvj}_C","fields":{"value_type":"int","exp1":"idLength","comparation":"==","exp2":"18"},"next":{"block":{"type":"Compare","id":"|.RX%SV{?/;q+ArqMK8N","fields":{"value_type":"str","exp1":"idStart","comparation":"!=","exp2":"'83'"}}}}}}}},"content":{"block":{"type":"SubString","id":"]jn|uHKx4Ki|(O*/Yz`6","fields":{"str":"srcRow['证件号']","head":"7","tail":"10","VAR":"y"},"next":{"block":{"type":"SubString","id":"O@|7D+lBdK;gm{!$ie4;","fields":{"str":"srcRow['证件号']","head":"11","tail":"12","VAR":"m"},"next":{"block":{"type":"SubString","id":"^RVw:Dhd*N^An_qv_DL?","fields":{"str":"srcRow['证件号']","head":"13","tail":"14","VAR":"d"},"next":{"block":{"type":"setto","id":"l6Qx}6Ur0X@oKoC~wUk1","fields":{"exp":"y+'-'+m+'-'+d","VAR":"date"},"next":{"block":{"type":"setto","id":"`1Inkj=p`~gKwr*S2]~2","fields":{"exp":"date","VAR":"srcRow['出生日期']"},"next":{"block":{"type":"setto","id":"Gf@99^[}ORiHU1fcbK`N","fields":{"exp":"'中国'","VAR":"srcRow['国家及地区名称']"},"next":{"block":{"type":"setto","id":"deowyXHYOIqs*5sjr}[C","fields":{"exp":"'居民身份证'","VAR":"srcRow['证件代码']"},"next":{"block":{"type":"SubString","id":",r_H_QE^CvwH$CY+{8e3","fields":{"str":"srcRow['证件号']","head":"17","tail":"17","VAR":"sex"},"next":{"block":{"type":"IF","id":"APDV}Zj]!:qm}5mNn+9B","inputs":{"condition":{"block":{"type":"or","id":"aiCxD9iF,Rfk-VpY+sUK","inputs":{"condition1":{"block":{"type":"Compare","id":":2Q3c`@Fgk/D/2}$(kf|","fields":{"value_type":"str","exp1":"sex","comparation":"==","exp2":"'0'"},"next":{"block":{"type":"Compare","id":"[2sEDJI1p;l=aaQ?6}.b","fields":{"value_type":"str","exp1":"sex","comparation":"==","exp2":"'2'"},"next":{"block":{"type":"Compare","id":"`}68r0k,B]X?nII3ZCv(","fields":{"value_type":"str","exp1":"sex","comparation":"==","exp2":"'4'"},"next":{"block":{"type":"Compare","id":"gM@!Z=4bS*K^pL**|pS2","fields":{"value_type":"str","exp1":"sex","comparation":"==","exp2":"'6'"},"next":{"block":{"type":"Compare","id":"9:(vrYKwbNsA[CY}XvX=","fields":{"value_type":"str","exp1":"sex","comparation":"==","exp2":"'8'"}}}}}}}}}}}}}},"content":{"block":{"type":"setto","id":"Vd8*}@y8ngy7h(E1*kL4","fields":{"exp":"'女'","VAR":"srcRow['性别']"}}}},"next":{"block":{"type":"Else","id":"|MuX#_Kwq+@dzqg`0|f#","inputs":{"content":{"block":{"type":"setto","id":"W+rLmgDfLnrsn|0wqp_`","fields":{"exp":"'男'","VAR":"srcRow['性别']"}}}},"next":{"block":{"type":"SetAreaText","id":"-1~$fnR/ir:%5la(]{}X","fields":{"Workbook":"localInfo","row_from":"localIndex","row_to":"localIndex","column_from":"'D'","column_to":"'D'"},"next":{"block":{"type":"SetAreaText","id":".Ppn!dv^hXnRP1cnQAk4","fields":{"Workbook":"localInfo","row_from":"localIndex","row_to":"localIndex","column_from":"'K'","column_to":"'K'"},"next":{"block":{"type":"WriteRow","id":"29KiAOq}@xu09L`at]dC","fields":{"Workbook":"localInfo","row":"localIndex","column_from":"'A'","column_to":"'AX'","row_content":"srcRow","header_row":"1"},"next":{"block":{"type":"setto","id":"9nP*)1i?xQJsDn-~0oap","fields":{"exp":"localIndex + 1","VAR":"localIndex"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"next":{"block":{"type":"Else","id":"X$U-xBSY:+HYR~#k3he7","icons":{"comment":{"text":"外国","pinned":false,"height":80,"width":160}},"inputs":{"content":{"block":{"type":"IF","id":"]*]FodP^x/O~^?71u~O_","inputs":{"condition":{"block":{"type":"isNone","id":"e`%a0arxsPd6JNGK3Wlt","fields":{"VAR":"srcRow['出生日期']","option":" is"}}},"content":{"block":{"type":"setto","id":"@X[h=}DpPop+q^,4o5NQ","fields":{"exp":"'1990-01-01'","VAR":"srcRow['出生日期']"}}}},"next":{"block":{"type":"SetAreaText","id":"cRp,;xmGUu^(v]d.QqrC","fields":{"Workbook":"foreignInfo","row_from":"foreignIndex","row_to":"foreignIndex","column_from":"'D'","column_to":"'D'"},"next":{"block":{"type":"SetAreaText","id":"#R;e@iab3x^QHc2_-q$*","fields":{"Workbook":"foreignInfo","row_from":"foreignIndex","row_to":"foreignIndex","column_from":"'K'","column_to":"'K'"},"next":{"block":{"type":"WriteRow","id":"hW#Zx?ap)(kXljt9%0@^","fields":{"Workbook":"foreignInfo","row":"foreignIndex","column_from":"'A'","column_to":"'AX'","row_content":"srcRow","header_row":"1"},"next":{"block":{"type":"setto","id":"1D3d*1k(*hk6r$Y:+;E2","fields":{"exp":"foreignIndex+ 1","VAR":"foreignIndex"}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"next":{"block":{"type":"saveWorkbook","id":"#DPWgfF}R!A,vIx^9X;B","icons":{"comment":{"text":"保存新创建的工作簿，注意本系统目前仅支持xls格式","pinned":false,"height":80,"width":160}},"fields":{"Workbook":"localInfo","FILE":"'E:/SeniorFall/blocklyTest/myBlocklyContent/data/local.xls'"},"next":{"block":{"type":"saveWorkbook","id":"a3?s1^S;YIvTp^?dc=El","fields":{"Workbook":"foreignInfo","FILE":"'E:/SeniorFall/blocklyTest/myBlocklyContent/data/foreign.xls'"},"next":{"block":{"type":"saveWorkbook","id":"M4+6UXLDKvzID6QTRE%E","fields":{"Workbook":"nonResidentInfo","FILE":"'E:/SeniorFall/blocklyTest/myBlocklyContent/data/nonresident.xls'"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}]}}