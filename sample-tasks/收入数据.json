{"blocks":{"languageVersion":0,"blocks":[{"type":"openWorkbook","id":"c7#r5rhN1o;M]6P2p71-","x":165,"y":105,"icons":{"comment":{"text":"打开或创建所有需要的工作簿","pinned":true,"height":80,"width":160}},"fields":{"FILE":"'E:/github/FlowBot/data/测试数据.xls'","VAR":"src"},"next":{"block":{"type":"addWorkbook","id":"l;I/($6VzjFEY)(*w7JC","fields":{"VAR":"localInfo"},"next":{"block":{"type":"CreateSheet","id":"X7}KCRzan,f$A$N$N:,0","fields":{"Workbook":"localInfo","name":"'local'"},"next":{"block":{"type":"addWorkbook","id":"[|uQ07B0xm5uJrarr`-d","fields":{"VAR":"foreignInfo"},"next":{"block":{"type":"CreateSheet","id":"?V8h^h4R*Y}cZI380O_p","fields":{"Workbook":"foreignInfo","name":"'foreign'"},"next":{"block":{"type":"addWorkbook","id":"S@41N;/b./#b?W|Ou%P.","fields":{"VAR":"nonResidentInfo"},"next":{"block":{"type":"CreateSheet","id":"]7:_|qk!`(,g4xNY4[ma","fields":{"Workbook":"nonResidentInfo","name":"'nonResident'"},"next":{"block":{"type":"fetchRowNoheader","id":"sAvT)(2;ScGm7%a|(DFa","icons":{"comment":{"text":"为新建的三个工作簿填写表头","pinned":false,"height":80,"width":160}},"fields":{"Workbook":"src","row":"4","columnF":"'A'","columnT":"'D'","VAR":"infoHeader"},"next":{"block":{"type":"WriteRowNoheader","id":"oSeE%ekz|Fg$65@yVMFr","fields":{"Workbook":"localInfo","row":"1","column_from":"'A'","column_to":"'D'","row_content":"infoHeader"},"next":{"block":{"type":"fetchRowNoheader","id":"I=sOONj!c}T-o@;gA{t/","fields":{"Workbook":"src","row":"4","columnF":"'G'","columnT":"'G'","VAR":"infoHeader"},"next":{"block":{"type":"WriteRowNoheader","id":"XKKEJ/T=M]7?hsdN({m=","fields":{"Workbook":"localInfo","row":"1","column_from":"'E'","column_to":"'E'","row_content":"infoHeader"},"next":{"block":{"type":"SetCellValue","id":"lyeA44{1X^}?Pig0q)Cw","fields":{"Workbook":"localInfo","row":"1","column":"'F'","value":"'免税收入'"},"next":{"block":{"type":"SetCellValue","id":"E@MvyWl$:.G`f}GzjT~-","fields":{"Workbook":"localInfo","row":"1","column":"'G'","value":"'商业健康保险'"},"next":{"block":{"type":"SetCellValue","id":"%AR]BT:D#qH:HDT$mg:{","fields":{"Workbook":"localInfo","row":"1","column":"'H'","value":"'税延养老保险'"},"next":{"block":{"type":"SetCellValue","id":"T91gR9c:c!!iKNx$T[cM","fields":{"Workbook":"localInfo","row":"1","column":"'I'","value":"'其他'"},"next":{"block":{"type":"SetCellValue","id":"*^`)!2TWM%pECY]Ku{EU","fields":{"Workbook":"localInfo","row":"1","column":"'J'","value":"'备注'"},"next":{"block":{"type":"SetCellValue","id":"H4km0._8eV2!9FXoYuF;","fields":{"Workbook":"localInfo","row":"1","column":"'K'","value":"'允许扣除的税费'"},"next":{"block":{"type":"SetCellValue","id":"IZ$#z0hp55:TV`R%Mcqe","fields":{"Workbook":"localInfo","row":"1","column":"'L'","value":"'减免税额'"},"next":{"block":{"type":"fetchRowNoheader","id":"piSdVL^ma]UWi6~4E:bg","fields":{"Workbook":"localInfo","row":"1","columnF":"'A'","columnT":"'L'","VAR":"infoHeader"},"next":{"block":{"type":"WriteRowNoheader","id":"AX!$*ltTO(H^!P|(/wNG","fields":{"Workbook":"foreignInfo","row":"1","column_from":"'A'","column_to":"'L'","row_content":"infoHeader"},"next":{"block":{"type":"WriteRowNoheader","id":"#kxrX,Nw~0~nGB2$`gcg","fields":{"Workbook":"nonResidentInfo","row":"1","column_from":"'A'","column_to":"'L'","row_content":"infoHeader"},"next":{"block":{"type":"setto","id":"-m.[mkgy6AKC3zc`vpw/","icons":{"comment":{"text":"这三个变量用于指示在新建的工作簿中写入的行号，第1行为表头，所以初始值为2","pinned":false,"height":80,"width":160}},"fields":{"exp":"2","VAR":"localIndex"},"next":{"block":{"type":"setto","id":"2Iy0g@6[rX+MZ^[GWM04","fields":{"exp":"2","VAR":"foreignIndex"},"next":{"block":{"type":"setto","id":"`ohjaS|[8IC`lUFouRQt","fields":{"exp":"2","VAR":"nonResidentIndex"},"next":{"block":{"type":"For","id":"l(,/U~3d_py.*5{w49Zz","icons":{"comment":{"text":"循环，对源工作簿的每一行数据做同样的操作","pinned":false,"height":80,"width":160}},"fields":{"VAR":"i","start":"5","end":"144"},"inputs":{"content":{"block":{"type":"fetchRow","id":"=I7}2!m]S,P`wW@InfUV","fields":{"Workbook":"src","row":"i","columnF":"'A'","columnT":"'BQ'","VAR":"srcRow","header_row":"4"},"next":{"block":{"type":"GetStringLength","id":"S1ToZw:oB,*TM@-DXfm!","icons":{"comment":{"text":"为后续if else的逻辑块准备需要使用的数据","pinned":false,"height":80,"width":160}},"fields":{"str":"srcRow['证件号']","VAR":"idLength"},"next":{"block":{"type":"SubString","id":"D`*mr^rdKoXr/0tluAM!","fields":{"str":"srcRow['证件号']","head":"1","tail":"2","VAR":"idStart"},"next":{"block":{"type":"IF","id":"a{5_5H?OVfY?K-c5S`QP","icons":{"comment":{"text":"非居民","pinned":false,"height":80,"width":160}},"inputs":{"condition":{"block":{"type":"or","id":"Qf-$6dWY35ZTB?U:n^0_","inputs":{"condition1":{"block":{"type":"Compare","id":"%(U=VT?%/bNnRX3hnaYd","fields":{"value_type":"float","exp1":"srcRow['劳务收入_劳务税非居民']","comparation":">","exp2":"0"},"next":{"block":{"type":"Compare","id":"QjO#KhMD0y^=4.fp.aSF","fields":{"value_type":"float","exp1":"srcRow['劳务税率_劳务税非居民']","comparation":">","exp2":"0"},"next":{"block":{"type":"Compare","id":"qUOr^55(e29lP$!khBUj","fields":{"value_type":"float","exp1":"srcRow['劳务实发_劳务税非居民']","comparation":">","exp2":"0"},"next":{"block":{"type":"Compare","id":"0+q#S2W1hSQY1t8^j[[s","fields":{"value_type":"float","exp1":"srcRow['劳务税_劳务税非居民']","comparation":">","exp2":"0"},"next":{"block":{"type":"Compare","id":"FLz_NTAVU;FnmZ42*9)1","fields":{"value_type":"float","exp1":"srcRow['劳务应扣税_劳务税非居民']","comparation":">","exp2":"0"}}}}}}}}}}}}}},"content":{"block":{"type":"SetAreaText","id":"juK|+hpZSj`NLcji2`E`","icons":{"comment":{"text":"手机号码和身份证号有可能会被错误地解释为数字，需要修改单元格的数据类型。\n此处必须先修改数据类型再写入，若调换顺序会出现问题。","pinned":false,"height":80,"width":160}},"fields":{"Workbook":"nonResidentInfo","row_from":"nonResidentIndex","row_to":"nonResidentIndex","column_from":"'D'","column_to":"'D'"},"next":{"block":{"type":"WriteRow","id":"hoqAssqg6695J*,?kir8","fields":{"Workbook":"nonResidentInfo","row":"nonResidentIndex","column_from":"'A'","column_to":"'L'","row_content":"srcRow","header_row":"1"},"next":{"block":{"type":"setto","id":"c{SxYW!-u-{sWe7W6Gct","icons":{"comment":{"text":"写入一行后，将用于指示写入行的变量加1，指向下一行","pinned":false,"height":80,"width":160}},"fields":{"exp":"nonResidentIndex + 1","VAR":"nonResidentIndex"}}}}}}}},"next":{"block":{"type":"Elif","id":"B(+;|g8s3xqMpI6}Z;wY","icons":{"comment":{"text":"中国","pinned":false,"height":80,"width":160}},"inputs":{"condition":{"block":{"type":"and","id":"XT:T_]~@y|i]0}x)2K*W","inputs":{"condition1":{"block":{"type":"Compare","id":"b~FM=vuK^{[C)*tg.:%N","fields":{"value_type":"int","exp1":"idLength","comparation":"==","exp2":"18"},"next":{"block":{"type":"Compare","id":"!Mgv~*R0Ael?,Fc|LI7q","fields":{"value_type":"str","exp1":"idStart","comparation":"!=","exp2":"'83'"}}}}}}}},"content":{"block":{"type":"setto","id":"`^bA#/c,XmzmrJN2#ooS","fields":{"exp":"'居民身份证'","VAR":"srcRow['证件代码']"},"next":{"block":{"type":"SetAreaText","id":"rdx^rCVi}^^h3ySv;}MZ","fields":{"Workbook":"localInfo","row_from":"localIndex","row_to":"localIndex","column_from":"'D'","column_to":"'D'"},"next":{"block":{"type":"WriteRow","id":"A`4_i,o+-SG(YT_wDW#I","fields":{"Workbook":"localInfo","row":"localIndex","column_from":"'A'","column_to":"'L'","row_content":"srcRow","header_row":"1"},"next":{"block":{"type":"setto","id":"PrTXyYHeq7*gHbT)7?H3","fields":{"exp":"localIndex + 1","VAR":"localIndex"}}}}}}}}}},"next":{"block":{"type":"Else","id":"cnbeW89,Wr+eMT.1a%V3","icons":{"comment":{"text":"外国","pinned":false,"height":80,"width":160}},"inputs":{"content":{"block":{"type":"SetAreaText","id":"if;f2LY4V0dC4~{gzR+(","fields":{"Workbook":"foreignInfo","row_from":"foreignIndex","row_to":"foreignIndex","column_from":"'D'","column_to":"'D'"},"next":{"block":{"type":"WriteRow","id":")CvMq`p6r{d=e]Ehn5v.","fields":{"Workbook":"foreignInfo","row":"foreignIndex","column_from":"'A'","column_to":"'L'","row_content":"srcRow","header_row":"1"},"next":{"block":{"type":"setto","id":"{sU}+Qmx#RZYy~6,-hNn","fields":{"exp":"foreignIndex+ 1","VAR":"foreignIndex"}}}}}}}}}}}}}}}}}}}}},"next":{"block":{"type":"saveWorkbook","id":"|u;|YD=|CJaN1Xl)pwS{","icons":{"comment":{"text":"保存新创建的工作簿，注意本系统目前仅支持xls格式","pinned":false,"height":80,"width":160}},"fields":{"Workbook":"localInfo","FILE":"'E:/github/FlowBot/output/local.xls'"},"next":{"block":{"type":"saveWorkbook","id":"~26=FqPeH#|(`MR*~?;e","fields":{"Workbook":"foreignInfo","FILE":"'E:/github/FlowBot/output/foreign.xls'"},"next":{"block":{"type":"saveWorkbook","id":"`)t2nfG14J~*6pY$CLc|","fields":{"Workbook":"nonResidentInfo","FILE":"'E:/github/FlowBot/output/nonresident.xls'"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}]}}